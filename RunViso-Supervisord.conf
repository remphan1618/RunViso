[program:kasmvnc]
# Modified command:
# - Run kasmvncserver as the specified user.
# - Redirect stderr (2) to stdout (1) using '2>&1'.
# - Pipe (|) the combined output to 'tee'.
# - 'tee -a' appends the output to the specified file in /var/log/portal/.
# - We use 'sh -c "..."' to handle the redirection and pipe correctly within supervisor.
command=sh -c '/usr/bin/kasmvncserver -u %(ENV_KASM_USER)s 2>&1 | tee -a /var/log/portal/kasmvnc.log'
# Run the supervisor process itself as root
user=root
autostart=true
autorestart=true
# Remove stdout/stderr logfile directives; tee handles logging now
# stdout_logfile=/var/log/supervisor/kasmvnc.log
# stderr_logfile=/var/log/supervisor/kasmvnc_err.log
# Ensure KASM_USER is available if needed by the process environment
environment=USER="%(ENV_KASM_USER)s"